# HRE ì—°ê²°ë§ˆìŠ¤í„° Power Query ì „ì²´ ê°€ì´ë“œ

**ì‘ì„±ì¼**: 2026-01-23
**ë²„ì „**: 1.00
**ëª©ì **: HRE ì—°ê²°ë§ˆìŠ¤í„°ì— í•„ìš”í•œ ëª¨ë“  Power Query M ì½”ë“œ ë° ì„¤ì • ê°€ì´ë“œ

---

## ğŸ“‹ ëª©ì°¨

1. [HideSheet í…Œì´ë¸” êµ¬ì¡°](#1-hidesheet-í…Œì´ë¸”-êµ¬ì¡°)
2. [ê¸°ë³¸ ì„¤ì • ì¿¼ë¦¬](#2-ê¸°ë³¸-ì„¤ì •-ì¿¼ë¦¬)
3. [ë°ì´í„° ì†ŒìŠ¤ ì¿¼ë¦¬](#3-ë°ì´í„°-ì†ŒìŠ¤-ì¿¼ë¦¬)
4. [ë°ì´í„° ë³€í™˜ ì¿¼ë¦¬](#4-ë°ì´í„°-ë³€í™˜-ì¿¼ë¦¬)
5. [ì¿¼ë¦¬ ìƒì„± ìˆœì„œ](#5-ì¿¼ë¦¬-ìƒì„±-ìˆœì„œ)
6. [ë¬¸ì œ í•´ê²°](#6-ë¬¸ì œ-í•´ê²°)

---

## 1. HideSheet í…Œì´ë¸” êµ¬ì¡°

### 1.1 í•„ìˆ˜ í…Œì´ë¸” ìƒì„±

HideSheet ì‹œíŠ¸ì— ë‹¤ìŒ í…Œì´ë¸”ë“¤ì„ **ë°˜ë“œì‹œ** ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤:

#### í…Œì´ë¸” 1: Path (SPO ë©”ì¸ ì£¼ì†Œ)
**ìœ„ì¹˜**: E1:E2

| Path |
|------|
| https://pwckor.sharepoint.com/sites/KR-ASR-HRE_Consolidation |

**ìƒì„± ë°©ë²•**:
1. E1 ì…€ì— `Path` ì…ë ¥
2. E2 ì…€ì— SPO URL ì…ë ¥
3. E1:E2 ë²”ìœ„ ì„ íƒ â†’ Ctrl+T â†’ í…Œì´ë¸” ìƒì„±
4. í…Œì´ë¸” ì´ë¦„: `Path`

---

#### í…Œì´ë¸” 2: TempPath (íšŒì‚¬ê²°ì‚° í´ë” ê²½ë¡œ)
**ìœ„ì¹˜**: H1:H2

| ê²½ë¡œ |
|------|
| /Shared Documents/â˜…ì‹œì—°ìš©í´ë”â˜…/HRE/2512 |

**ìƒì„± ë°©ë²•**:
1. H1 ì…€ì— `ê²½ë¡œ` ì…ë ¥
2. H2 ì…€ì— í´ë” ê²½ë¡œ ì…ë ¥ (frmDirectoryì—ì„œ ì„ íƒí•˜ë©´ ìë™ ì…ë ¥)
3. H1:H2 ë²”ìœ„ ì„ íƒ â†’ Ctrl+T â†’ í…Œì´ë¸” ìƒì„±
4. í…Œì´ë¸” ì´ë¦„: `TempPath`

**ì¤‘ìš”**: ê²½ë¡œëŠ” `/Shared Documents/` ë¶€í„° ì‹œì‘í•´ì•¼ í•¨!

---

#### í…Œì´ë¸” 3: ê²°ì‚°ì—°ì›”
**ìœ„ì¹˜**: A1:B2

| ê²°ì‚°ì—°ë„ | ê²°ì‚°ì›” |
|---------|--------|
| 2025 | 12 |

**ìƒì„± ë°©ë²•**:
1. A1:B1ì— `ê²°ì‚°ì—°ë„`, `ê²°ì‚°ì›”` ì…ë ¥
2. A2:B2ì— ê°’ ì…ë ¥
3. A1:B2 ë²”ìœ„ ì„ íƒ â†’ Ctrl+T â†’ í…Œì´ë¸” ìƒì„±
4. í…Œì´ë¸” ì´ë¦„: `ê²°ì‚°ì—°ì›”`

---

#### í…Œì´ë¸” 4: Mode (Scope ëª¨ë“œ)
**ìœ„ì¹˜**: C1:C2

| Mode |
|------|
| Full-Scope |

**ì˜µì…˜**: `Full-Scope` ë˜ëŠ” `ì§€ë¶„ë²•`

---

### 1.2 HideSheet ì „ì²´ ë ˆì´ì•„ì›ƒ

```
     A          B        C          D        E                              F     G     H
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
1 â”‚ ê²°ì‚°ì—°ë„  â”‚ ê²°ì‚°ì›”  â”‚ Mode      â”‚        â”‚ Path                        â”‚     â”‚     â”‚ ê²½ë¡œ                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
2 â”‚ 2025     â”‚ 12     â”‚ Full-Scopeâ”‚        â”‚ https://pwckor.sharepoint...â”‚     â”‚     â”‚ /Shared Documents/...â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ê¸°ë³¸ ì„¤ì • ì¿¼ë¦¬

### 2.1 ë©”ì¸ì£¼ì†Œ ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `ë©”ì¸ì£¼ì†Œ`
**ìš©ë„**: SPO ì‚¬ì´íŠ¸ URLì„ ë‹¤ë¥¸ ì¿¼ë¦¬ì—ì„œ ì°¸ì¡°

```m
let
    ê²½ë¡œ = Excel.CurrentWorkbook(){[Name="Path"]}[Content],
    ê²½ë¡œí…ìŠ¤íŠ¸ = Text.From(ê²½ë¡œ{0}[Path])
in
    ê²½ë¡œí…ìŠ¤íŠ¸
```

**ìƒì„± ë°©ë²•**:
1. ë°ì´í„° â†’ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° â†’ ê¸°íƒ€ ì›ë³¸ì—ì„œ â†’ ë¹ˆ ì¿¼ë¦¬
2. ê³ ê¸‰ í¸ì§‘ê¸°ì— ìœ„ ì½”ë“œ ë¶™ì—¬ë„£ê¸°
3. ë‹«ê¸° ë° ë¡œë“œ â†’ ì—°ê²°ë§Œ ë§Œë“¤ê¸°

---

### 2.2 íšŒì‚¬ê²°ì‚° ì£¼ì†Œ ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `íšŒì‚¬ê²°ì‚° ì£¼ì†Œ`
**ìš©ë„**: ì‹œì‚°í‘œ íŒŒì¼ì´ ìˆëŠ” í´ë” ê²½ë¡œ

```m
let
    ê²½ë¡œ = Excel.CurrentWorkbook(){[Name="TempPath"]}[Content],
    ê²½ë¡œí…ìŠ¤íŠ¸ = Text.From(ê²½ë¡œ{0}[ê²½ë¡œ])
in
    ê²½ë¡œí…ìŠ¤íŠ¸
```

---

### 2.3 Mode ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `Mode`
**ìš©ë„**: Full-Scope / ì§€ë¶„ë²• êµ¬ë¶„

```m
let
    ì›ë³¸ = Excel.CurrentWorkbook(){[Name="Mode"]}[Content],
    #"ë³€ê²½ëœ ìœ í˜•" = Table.TransformColumnTypes(ì›ë³¸,{{"Mode", type text}})
in
    #"ë³€ê²½ëœ ìœ í˜•"
```

---

### 2.4 ë””ë ‰í„°ë¦¬ ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `ë””ë ‰í„°ë¦¬`
**ìš©ë„**: SPO í´ë” êµ¬ì¡° ìŠ¤ìº” (frmDirectoryì˜ TreeViewìš©)

```m
let
    ì›ë³¸ = SharePoint.Files(ë©”ì¸ì£¼ì†Œ, [ApiVersion = 15]),
    #"ì œê±°ëœ ë‹¤ë¥¸ ì—´ ìˆ˜" = Table.SelectColumns(ì›ë³¸,{"Folder Path", "Name"}),
    #"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• 1" = Table.SplitColumn(#"ì œê±°ëœ ë‹¤ë¥¸ ì—´ ìˆ˜", "Folder Path", Splitter.SplitTextByEachDelimiter({"/"}, QuoteStyle.Csv, true), {"Folder Path.1", "Folder Path.2"}),
    #"ì œê±°ëœ ì—´ ìˆ˜" = Table.RemoveColumns(#"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• 1",{"Folder Path.2"}),
    #"ë³‘í•©ëœ ì—´ ìˆ˜" = Table.CombineColumns(#"ì œê±°ëœ ì—´ ìˆ˜",{"Folder Path.1", "Name"},Combiner.CombineTextByDelimiter("/", QuoteStyle.None),"ë³‘í•©ë¨"),
    #"ì œê±°ëœ ì¤‘ë³µ í•­ëª© ìˆ˜" = Table.Distinct(#"ë³‘í•©ëœ ì—´ ìˆ˜"),
    #"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• " = Table.SplitColumn(#"ì œê±°ëœ ì¤‘ë³µ í•­ëª© ìˆ˜", "ë³‘í•©ë¨", Splitter.SplitTextByDelimiter("/", QuoteStyle.None), {"ë³‘í•©ë¨.1", "ë³‘í•©ë¨.2", "ë³‘í•©ë¨.3", "ë³‘í•©ë¨.4", "ë³‘í•©ë¨.5", "ë³‘í•©ë¨.6", "ë³‘í•©ë¨.7", "ë³‘í•©ë¨.8", "ë³‘í•©ë¨.9", "ë³‘í•©ë¨.10", "ë³‘í•©ë¨.11", "ë³‘í•©ë¨.12", "ë³‘í•©ë¨.13", "ë³‘í•©ë¨.14", "ë³‘í•©ë¨.15"}),
    #"ë³€ê²½ëœ ìœ í˜•" = Table.TransformColumnTypes(#"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• ",{{"ë³‘í•©ë¨.1", type text}, {"ë³‘í•©ë¨.2", type text}, {"ë³‘í•©ë¨.3", type text}, {"ë³‘í•©ë¨.4", type text}, {"ë³‘í•©ë¨.5", type text}, {"ë³‘í•©ë¨.6", type text}, {"ë³‘í•©ë¨.7", type text}, {"ë³‘í•©ë¨.8", type text}, {"ë³‘í•©ë¨.9", type text}, {"ë³‘í•©ë¨.10", type text}, {"ë³‘í•©ë¨.11", type text}}),
    #"ì œê±°ëœ ë¹ˆ ì—´" = Table.SelectColumns(#"ë³€ê²½ëœ ìœ í˜•", List.Select(Table.ColumnNames(#"ë³€ê²½ëœ ìœ í˜•"), each List.NonNullCount(Table.Column(#"ë³€ê²½ëœ ìœ í˜•", _)) > 0)),
    #"ì œê±°ëœ ì—´ ìˆ˜1" = Table.RemoveColumns(#"ì œê±°ëœ ë¹ˆ ì—´",{"ë³‘í•©ë¨.1", "ë³‘í•©ë¨.2", "ë³‘í•©ë¨.3", "ë³‘í•©ë¨.4", "ë³‘í•©ë¨.5"}),

    // í´ë” ê²½ë¡œ ê·¸ë£¹ ìƒì„± (ë§ˆì§€ë§‰ íŒŒì¼ëª… ì œì™¸)
    #"í´ë”ê²½ë¡œ_ìƒì„±" = Table.AddColumn(#"ì œê±°ëœ ì—´ ìˆ˜1", "í´ë”ê²½ë¡œ", each
        let
            colNames = Table.ColumnNames(#"ì œê±°ëœ ì—´ ìˆ˜1"),
            values = List.Transform(colNames, (col) => Record.Field(_, col)),
            nonNullValues = List.Select(values, each _ <> null and _ <> ""),
            pathCount = List.Count(nonNullValues)
        in
            if pathCount <= 1 then "" else Text.Combine(List.FirstN(nonNullValues, pathCount - 1), "/")
    ),

    // í´ë”ê²½ë¡œë³„ë¡œ ì¤‘ë³µ ì œê±° (ì²« ë²ˆì§¸ í–‰ë§Œ ìœ ì§€)
    #"í´ë”ë³„_ì¤‘ë³µì œê±°" = Table.Group(#"í´ë”ê²½ë¡œ_ìƒì„±", {"í´ë”ê²½ë¡œ"}, {{"ë°ì´í„°", each Table.FirstN(_, 1), type table}}),
    #"í…Œì´ë¸”_í™•ì¥" = Table.ExpandTableColumn(#"í´ë”ë³„_ì¤‘ë³µì œê±°", "ë°ì´í„°", List.Difference(Table.ColumnNames(#"í´ë”ê²½ë¡œ_ìƒì„±"), {"í´ë”ê²½ë¡œ"})),

    // ê° í–‰ì—ì„œ ë§ˆì§€ë§‰ non-null ì—´ ì°¾ì•„ì„œ nullë¡œ ë³€ê²½
    #"ë§ˆì§€ë§‰ì—´_ì°¾ê¸°" = Table.AddColumn(#"í…Œì´ë¸”_í™•ì¥", "ë§ˆì§€ë§‰ì—´ìœ„ì¹˜", each
        let
            colNames = Table.ColumnNames(#"ì œê±°ëœ ì—´ ìˆ˜1"),
            nonNullPositions = List.Positions(List.Transform(colNames, (col) => Record.Field(_, col))),
            filteredPositions = List.Select(nonNullPositions, (pos) =>
                let value = Record.Field(_, colNames{pos})
                in value <> null and value <> ""
            )
        in
            if List.Count(filteredPositions) > 0 then List.Last(filteredPositions) else -1
    ),

    // ë™ì ìœ¼ë¡œ ë§ˆì§€ë§‰ ì—´ì„ nullë¡œ ë³€ê²½
    columnNames = Table.ColumnNames(#"ì œê±°ëœ ì—´ ìˆ˜1"),
    #"ë§ˆì§€ë§‰ì—´_nullì²˜ë¦¬" = List.Accumulate(
        List.Positions(columnNames),
        #"ë§ˆì§€ë§‰ì—´_ì°¾ê¸°",
        (state, colIndex) =>
            Table.ReplaceValue(
                state,
                each Record.Field(_, columnNames{colIndex}),
                each if [ë§ˆì§€ë§‰ì—´ìœ„ì¹˜] = colIndex then null else Record.Field(_, columnNames{colIndex}),
                Replacer.ReplaceValue,
                {columnNames{colIndex}}
            )
    ),

    // ì„ì‹œ ì—´ë“¤ ì œê±°
    #"ìµœì¢…ê²°ê³¼" = Table.RemoveColumns(#"ë§ˆì§€ë§‰ì—´_nullì²˜ë¦¬", {"í´ë”ê²½ë¡œ", "ë§ˆì§€ë§‰ì—´ìœ„ì¹˜"})
in
    #"ìµœì¢…ê²°ê³¼"
```

**ë¡œë“œ ìœ„ì¹˜**: DirectoryURL ì‹œíŠ¸, í…Œì´ë¸” ì´ë¦„ `ë””ë ‰í„°ë¦¬`

---

## 3. ë°ì´í„° ì†ŒìŠ¤ ì¿¼ë¦¬

### 3.1 Raw_Data ì¿¼ë¦¬ (í•µì‹¬!)

**ì¿¼ë¦¬ ì´ë¦„**: `Raw_Data`
**ìš©ë„**: SharePointì—ì„œ ì‹œì‚°í‘œ íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°

```m
let
    ê²°ì‚°ì—°ì›” = Excel.CurrentWorkbook(){[Name="ê²°ì‚°ì—°ì›”"]}[Content],
    ê²°ì‚°ì—°ë„ = Text.End(Text.From(ê²°ì‚°ì—°ì›”{0}[ê²°ì‚°ì—°ë„]),2),
    ê²°ì‚°ì›” = Text.PadStart(Text.From(ê²°ì‚°ì—°ì›”{0}[ê²°ì‚°ì›”]), 2, "0"),
    í´ë”ê²½ë¡œ = #"íšŒì‚¬ê²°ì‚° ì£¼ì†Œ",
    ì›ë³¸ = SharePoint.Files(ë©”ì¸ì£¼ì†Œ, [ApiVersion = 15]),
    #"í•„í„°ë§ëœ í–‰" = Table.SelectRows(ì›ë³¸, each Text.StartsWith([Folder Path], í´ë”ê²½ë¡œ)),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©" = Table.AddColumn(#"í•„í„°ë§ëœ í–‰", "Code", each Text.BetweenDelimiters([Folder Path], "[", "]")),
    #"ë³€ê²½ëœ ìœ í˜•" = Table.TransformColumnTypes(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©",{{"Code", type text}}),
    #"í•„í„°ë§ëœ í–‰1" = Table.SelectRows(#"ë³€ê²½ëœ ìœ í˜•", each List.Contains(Corp[ë²•ì¸ì½”ë“œ], [Code])),
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜" = Table.RenameColumns(#"í•„í„°ë§ëœ í–‰1",{{"Code", "ë²•ì¸ì½”ë“œ"}}),
    #"ìµœì¢… í•„í„°ë§" = if Text.From(Mode{0}[Mode]) = "Full-Scope"
        then #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜"
        else Table.SelectRows(#"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜", each Text.Contains([Name], "_ì§€ë¶„ë²•"))
in
    #"ìµœì¢… í•„í„°ë§"
```

**ì¤‘ìš”**: ì´ ì¿¼ë¦¬ëŠ” í´ë” êµ¬ì¡°ì—ì„œ `[ë²•ì¸ì½”ë“œ]` íŒ¨í„´ì„ ì°¾ìŠµë‹ˆë‹¤.

**ì˜ˆìƒ í´ë” êµ¬ì¡°**:
```
/Shared Documents/â˜…ì‹œì—°ìš©í´ë”â˜…/HRE/2512/[HRE-001]/íŒŒì¼ë“¤.xlsx
                                        â””â”€â”€â”€â”€â”€â”´â”€ ë²•ì¸ì½”ë“œ ì¶”ì¶œ
```

---

### 3.2 Corp ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `Corp`
**ìš©ë„**: Scopeê°€ "O"ì¸ ë²•ì¸ ëª©ë¡

```m
let
    ì›ë³¸ = Excel.CurrentWorkbook(){[Name="Corp"]}[Content],
    #"ë³€ê²½ëœ ìœ í˜•" = Table.TransformColumnTypes(ì›ë³¸,{{"No", Int64.Type}, {"ë²•ì¸ì½”ë“œ", Int64.Type}, {"ë²•ì¸ëª…", type text}, {"Hierarchy", type text}, {"ìœ íš¨ì§€ë¶„ìœ¨", type any}}),
    #"í•„í„°ë§ëœ í–‰" = Table.SelectRows(#"ë³€ê²½ëœ ìœ í˜•", each ([Scope] = "O")),
    #"ì œê±°ëœ ë‹¤ë¥¸ ì—´ ìˆ˜" = Table.SelectColumns(#"í•„í„°ë§ëœ í–‰",{"ë²•ì¸ì½”ë“œ"}),
    #"ë³€ê²½ëœ ìœ í˜•1" = Table.TransformColumnTypes(#"ì œê±°ëœ ë‹¤ë¥¸ ì—´ ìˆ˜",{{"ë²•ì¸ì½”ë“œ", type text}})
in
    #"ë³€ê²½ëœ ìœ í˜•1"
```

---

### 3.3 Corp_Date ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `Corp_Date`
**ìš©ë„**: ë²•ì¸ë³„ ì‹œì‘ì›”/ì¢…ë£Œì›” ê³„ì‚°

```m
let
    ì›ë³¸ = Excel.CurrentWorkbook(){[Name="Corp"]}[Content],
    ê²°ì‚°ì—°ì›” = Excel.CurrentWorkbook(){[Name="ê²°ì‚°ì—°ì›”"]}[Content],
    #"ë³€ê²½ëœ ìœ í˜•" = Table.TransformColumnTypes(ì›ë³¸,{{"No", Int64.Type}, {"ë²•ì¸ì½”ë“œ", Int64.Type}, {"ë²•ì¸ëª…", type text}}),
    #"í•„í„°ë§ëœ í–‰" = Table.SelectRows(#"ë³€ê²½ëœ ìœ í˜•", each ([Scope] = "O")),
    #"ì œê±°ëœ ë‹¤ë¥¸ ì—´ ìˆ˜1" = Table.SelectColumns(#"í•„í„°ë§ëœ í–‰",{"In-scope Date#(lf)(ì„¤ë¦½ì¼, ì·¨ë“ì¼ ë“±)", "Scope-out Date#(lf)(ë§¤ê°ì¼, ì²­ì‚°ì¼ ë“±)", "ë²•ì¸ì½”ë“œ"}),
    #"ë°”ê¾¼ ê°’" = Table.ReplaceValue(#"ì œê±°ëœ ë‹¤ë¥¸ ì—´ ìˆ˜1","-","9999-12-31",Replacer.ReplaceText,{"Scope-out Date#(lf)(ë§¤ê°ì¼, ì²­ì‚°ì¼ ë“±)"}),
    #"ë³€ê²½ëœ ìœ í˜•1" = Table.TransformColumnTypes(#"ë°”ê¾¼ ê°’",{{"In-scope Date#(lf)(ì„¤ë¦½ì¼, ì·¨ë“ì¼ ë“±)", type date}, {"ë²•ì¸ì½”ë“œ", type text}, {"Scope-out Date#(lf)(ë§¤ê°ì¼, ì²­ì‚°ì¼ ë“±)", type date}}),
    #"ë°”ê¾¼ ì˜¤ë¥˜" = Table.ReplaceErrorValues(#"ë³€ê²½ëœ ìœ í˜•1", {{"In-scope Date#(lf)(ì„¤ë¦½ì¼, ì·¨ë“ì¼ ë“±)", #date(2000, 1, 1)}}),
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜" = Table.RenameColumns(#"ë°”ê¾¼ ì˜¤ë¥˜",{{"In-scope Date#(lf)(ì„¤ë¦½ì¼, ì·¨ë“ì¼ ë“±)", "ì·¨ë“ì¼"}, {"Scope-out Date#(lf)(ë§¤ê°ì¼, ì²­ì‚°ì¼ ë“±)", "ì²˜ë¶„ì¼"}}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì •" = Table.AddColumn(#"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜", "ì‹œì‘ì›”", each
        if Date.Year([ì·¨ë“ì¼]) = Number.From(Text.End(Text.From(ê²°ì‚°ì—°ì›”{0}[ê²°ì‚°ì—°ë„]), 4))
        then Date.Month([ì·¨ë“ì¼])
        else 1),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì •1" = Table.AddColumn(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì •", "ì¢…ë£Œì›”", each
        if Date.Year([ì²˜ë¶„ì¼]) = Number.From(Text.End(Text.From(ê²°ì‚°ì—°ì›”{0}[ê²°ì‚°ì—°ë„]), 4))
        then Date.Month([ì²˜ë¶„ì¼])
        else "0"),
    #"ë³€ê²½ëœ ìœ í˜•2" = Table.TransformColumnTypes(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì •1",{{"ì‹œì‘ì›”", type number}, {"ì¢…ë£Œì›”", type number}})
in
    #"ë³€ê²½ëœ ìœ í˜•2"
```

---

### 3.4 Master ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `Master`
**ìš©ë„**: CoAMaster í…Œì´ë¸” ì°¸ì¡°

```m
let
    ì›ë³¸ = Excel.CurrentWorkbook(){[Name="Master"]}[Content],
    ColumnNames = Table.ColumnNames(ì›ë³¸),
    ExcludedColumns = {"ë¶€í˜¸", "ê¸ˆì•¡"},
    TransformToText = List.Transform(
        ColumnNames,
        each if List.Contains(ExcludedColumns, _) then {_, type any} else {_, type text}
    ),
    #"ë³€ê²½ëœ ìœ í˜•" = Table.TransformColumnTypes(ì›ë³¸, TransformToText),
    #"ì§€ì •ëœ ì—´ ìœ í˜• ë³€ê²½" = Table.TransformColumnTypes(#"ë³€ê²½ëœ ìœ í˜•",{{"ë¶€í˜¸", Int64.Type}, {"ê¸ˆì•¡", Int64.Type}})
in
    #"ì§€ì •ëœ ì—´ ìœ í˜• ë³€ê²½"
```

---

### 3.5 CoA ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `CoA`
**ìš©ë„**: Raw_CoA í…Œì´ë¸” ê°€ê³µ

```m
let
    ì›ë³¸ = Excel.CurrentWorkbook(){[Name="Raw_CoA"]}[Content],
    #"ë³€ê²½ëœ ìœ í˜•" = Table.TransformColumnTypes(ì›ë³¸,{{"ë²•ì¸ì½”ë“œ", Int64.Type}, {"ê³„ì •ì½”ë“œ", Int64.Type}, {"ê³„ì •ê³¼ëª©ëª…", type text}, {"PwC_CoA", type text}, {"PwC_ê³„ì •ëª…", type text}, {"ë¹„ê³ ",type text}}),
    #"ë°”ê¾¼ ê°’" = Table.ReplaceValue(#"ë³€ê²½ëœ ìœ í˜•"," ","",Replacer.ReplaceText,{"ê³„ì •ê³¼ëª©ëª…"}),
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜" = Table.RenameColumns(#"ë°”ê¾¼ ê°’",{{"ê³„ì •ì½”ë“œ", "ë²•ì¸ ê³„ì •ì½”ë“œ"}, {"ê³„ì •ê³¼ëª©ëª…", "ë²•ì¸ ê³„ì •ê³¼ëª©ëª…"}}),
    #"ë³€ê²½ëœ ìœ í˜•1" = Table.TransformColumnTypes(#"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜",{{"ë²•ì¸ì½”ë“œ", type text}, {"ë²•ì¸ ê³„ì •ì½”ë“œ", type text}}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©" = Table.AddColumn(#"ë³€ê²½ëœ ìœ í˜•1", "ì‹ë³„ì½”ë“œ", each [ë²•ì¸ì½”ë“œ] & "_" & [ë²•ì¸ ê³„ì •ì½”ë“œ]),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜" = Table.ReorderColumns(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©",{"ì‹ë³„ì½”ë“œ", "ë²•ì¸ì½”ë“œ", "ë²•ì¸ ê³„ì •ì½”ë“œ", "ë²•ì¸ ê³„ì •ê³¼ëª©ëª…", "PwC_CoA", "PwC_ê³„ì •ëª…"}),
    #"ë³€ê²½ëœ ìœ í˜•2" = Table.TransformColumnTypes(#"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜",{{"ì‹ë³„ì½”ë“œ", type text}}),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜1" = Table.ReorderColumns(#"ë³€ê²½ëœ ìœ í˜•2",{"ì‹ë³„ì½”ë“œ", "ë²•ì¸ì½”ë“œ", "ë²•ì¸ ê³„ì •ì½”ë“œ", "ë²•ì¸ ê³„ì •ê³¼ëª©ëª…", "PwC_CoA", "PwC_ê³„ì •ëª…", "ë¹„ê³ "})
in
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜1"
```

---

### 3.6 CoA_Processed ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `CoA_Processed`
**ìš©ë„**: CoA ë°ì´í„° ì •ì œ (ì´ìµì‰ì—¬ê¸ˆ/ê²°ì†ê¸ˆ ì²˜ë¦¬)

```m
let
    ì›ë³¸ = CoA,
    #"ë³€ê²½ëœ ìœ í˜•" = Table.TransformColumnTypes(ì›ë³¸,{{"ì‹ë³„ì½”ë“œ", type text}, {"ë²•ì¸ì½”ë“œ", Int64.Type}, {"ë²•ì¸ ê³„ì •ì½”ë“œ", Int64.Type}, {"ë²•ì¸ ê³„ì •ê³¼ëª©ëª…", type text}, {"PwC_CoA", type text}, {"PwC_ê³„ì •ëª…", type text}}),
    #"ì œê±°ëœ ì—´ ìˆ˜1" = Table.RemoveColumns(#"ë³€ê²½ëœ ìœ í˜•",{"ì‹ë³„ì½”ë“œ"}),
    #"ë³€ê²½ëœ ìœ í˜•1" = Table.TransformColumnTypes(#"ì œê±°ëœ ì—´ ìˆ˜1",{{"ë²•ì¸ì½”ë“œ", type text}, {"ë²•ì¸ ê³„ì •ì½”ë“œ", type text}, {"ë²•ì¸ ê³„ì •ê³¼ëª©ëª…", type text}, {"PwC_CoA", type text}, {"PwC_ê³„ì •ëª…", type text}}),
    #"ì¡°ê±´ ì—´ì´ ì¶”ê°€ë¨" = Table.AddColumn(#"ë³€ê²½ëœ ìœ í˜•1", "ë²•ì¸ë³„ CoA", each if Text.Contains([ë²•ì¸ ê³„ì •ê³¼ëª©ëª…], "ì´ìµì‰ì—¬ê¸ˆ") then 39999 else if Text.Contains([ë²•ì¸ ê³„ì •ê³¼ëª©ëª…], "ê²°ì†ê¸ˆ") then 39999 else [ë²•ì¸ ê³„ì •ì½”ë“œ]),
    #"ë³€ê²½ëœ ìœ í˜•2" = Table.TransformColumnTypes(#"ì¡°ê±´ ì—´ì´ ì¶”ê°€ë¨",{{"ë²•ì¸ë³„ CoA", type text}}),
    #"ì œê±°ëœ ì—´ ìˆ˜2" = Table.RemoveColumns(#"ë³€ê²½ëœ ìœ í˜•2",{"ë²•ì¸ ê³„ì •ì½”ë“œ"}),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜" = Table.ReorderColumns(#"ì œê±°ëœ ì—´ ìˆ˜2",{"ë²•ì¸ì½”ë“œ", "ë²•ì¸ë³„ CoA", "ë²•ì¸ ê³„ì •ê³¼ëª©ëª…", "PwC_CoA", "PwC_ê³„ì •ëª…", "ë¹„ê³ "}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©" = Table.AddColumn(#"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜", "ì‹ë³„ì½”ë“œ", each [ë²•ì¸ì½”ë“œ] & "_" & [ë²•ì¸ë³„ CoA]),
    #"ë³€ê²½ëœ ìœ í˜•3" = Table.TransformColumnTypes(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©",{{"ì‹ë³„ì½”ë“œ", type text}}),
    #"ì œê±°ëœ ì¤‘ë³µ í•­ëª© ìˆ˜" = Table.Distinct(#"ë³€ê²½ëœ ìœ í˜•3", {"ì‹ë³„ì½”ë“œ"}),
    #"ì œê±°ëœ ì—´ ìˆ˜3" = Table.RemoveColumns(#"ì œê±°ëœ ì¤‘ë³µ í•­ëª© ìˆ˜",{"ë¹„ê³ "})
in
    #"ì œê±°ëœ ì—´ ìˆ˜3"
```

---

## 4. ë°ì´í„° ë³€í™˜ ì¿¼ë¦¬

### 4.1 BS ì¿¼ë¦¬ (ì¬ë¬´ìƒíƒœí‘œ)

**ì¿¼ë¦¬ ì´ë¦„**: `BS`
**ìš©ë„**: ì¬ë¬´ìƒíƒœí‘œ ë°ì´í„° ì¶”ì¶œ

```m
let
    ì›ë³¸ = Raw_Data,
    #"ì œê±°ëœ ì—´ ìˆ˜" = Table.RemoveColumns(ì›ë³¸,{"Extension", "Date accessed", "Date modified", "Date created", "Attributes", "Folder Path"}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©" = Table.AddColumn(#"ì œê±°ëœ ì—´ ìˆ˜", "ì‚¬ìš©ì ì§€ì •", each Excel.Workbook([Content])),
    #"ì œê±°ëœ ì—´ ìˆ˜1" = Table.RemoveColumns(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©",{"Content"}),
    #"í•„í„°ë§ëœ í–‰2" = Table.SelectRows(#"ì œê±°ëœ ì—´ ìˆ˜1", each Text.Contains([Name], "ì¬ë¬´ìƒíƒœí‘œ") and not Text.Contains([Name], "ì·¨ë“") and not Text.Contains([Name], "ì²˜ë¶„")),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜1" = Table.ReorderColumns(#"í•„í„°ë§ëœ í–‰2",{"ë²•ì¸ì½”ë“œ", "Name", "ì‚¬ìš©ì ì§€ì •"}),
    #"ì œê±°ëœ ì—´ ìˆ˜2" = Table.RemoveColumns(#"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜1",{"Name"}),
    #"í™•ì¥ëœ ì‚¬ìš©ì ì§€ì •" = Table.ExpandTableColumn(#"ì œê±°ëœ ì—´ ìˆ˜2", "ì‚¬ìš©ì ì§€ì •", {"Name", "Data", "Item", "Kind", "Hidden"}, {"Name", "Data", "Item", "Kind", "Hidden"}),
    #"ì œê±°ëœ ì—´ ìˆ˜3" = Table.RemoveColumns(#"í™•ì¥ëœ ì‚¬ìš©ì ì§€ì •",{"Name", "Item", "Kind", "Hidden"}),
    #"í™•ì¥ëœ Data" = Table.ExpandTableColumn(#"ì œê±°ëœ ì—´ ìˆ˜3", "Data", {"Column1", "Column2", "Column3", "Column4", "Column5"}, {"Column1", "Column2", "Column3", "Column4", "Column5"}),
    #"ë°”ê¾¼ ê°’3" = Table.ReplaceValue(#"í™•ì¥ëœ Data"," ","",Replacer.ReplaceText,{"Column1"}),
    #"ë°”ê¾¼ ê°’2" = Table.ReplaceValue(#"ë°”ê¾¼ ê°’3","ã€€",null,Replacer.ReplaceValue,{"Column2", "Column4"}),
    #"ì¡°ê±´ ì—´ì´ ì¶”ê°€ë¨" = Table.AddColumn(#"ë°”ê¾¼ ê°’2", "ì˜ˆì™¸", each if Text.Contains([Column1], "ë¯¸ì²˜ë¦¬") then "[39999]ë¯¸ì²˜ë¦¬ê²°ì†ê¸ˆ" else if Text.Contains([Column1], "ë¯¸ì²˜ë¶„") then "[39999]ë¯¸ì²˜ë¶„ì´ìµì‰ì—¬ê¸ˆ" else if Text.Contains([Column1], "[") then [Column1] else null),
    #"ì œê±°ëœ ì—´ ìˆ˜4" = Table.RemoveColumns(#"ì¡°ê±´ ì—´ì´ ì¶”ê°€ë¨",{"Column1"}),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜" = Table.ReorderColumns(#"ì œê±°ëœ ì—´ ìˆ˜4",{"ì˜ˆì™¸", "Column2", "Column3", "Column4", "Column5"}),
    #"ì œê±°ëœ ì˜¤ë¥˜ ìˆ˜" = Table.RemoveRowsWithErrors(#"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜", {"ì˜ˆì™¸"}),
    #"í•„í„°ë§ëœ í–‰" = Table.SelectRows(#"ì œê±°ëœ ì˜¤ë¥˜ ìˆ˜", each ([ì˜ˆì™¸] <> null)),
    #"í•„í„°ë§ëœ í–‰1" = Table.SelectRows(#"í•„í„°ë§ëœ í–‰", each not Text.Contains([ì˜ˆì™¸], "íšŒê³„ë‹¨ìœ„") and not Text.Contains([ì˜ˆì™¸], "ê¸°ì´ˆ") and not Text.Contains([ì˜ˆì™¸], "ë‹¹ê¸°") and not Text.Contains([ì˜ˆì™¸], "ê¸°ë§") and not Text.Contains([ì˜ˆì™¸], "íƒ€ê³„ì •")),
    #"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• 2" = Table.SplitColumn(#"í•„í„°ë§ëœ í–‰1", "ì˜ˆì™¸", Splitter.SplitTextByDelimiter("[", QuoteStyle.Csv), {"ì˜ˆì™¸.1", "ì˜ˆì™¸.2"}),
    #"ë³€ê²½ëœ ìœ í˜•4" = Table.TransformColumnTypes(#"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• 2",{{"ì˜ˆì™¸.1", type text}, {"ì˜ˆì™¸.2", type text}}),
    #"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• 3" = Table.SplitColumn(#"ë³€ê²½ëœ ìœ í˜•4", "ì˜ˆì™¸.2", Splitter.SplitTextByDelimiter("]", QuoteStyle.Csv), {"ì˜ˆì™¸.2.1", "ì˜ˆì™¸.2.2"}),
    #"ë³€ê²½ëœ ìœ í˜•5" = Table.TransformColumnTypes(#"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• 3",{{"ì˜ˆì™¸.2.1", Int64.Type}, {"ì˜ˆì™¸.2.2", type text}}),
    #"ì œê±°ëœ ì—´ ìˆ˜5" = Table.RemoveColumns(#"ë³€ê²½ëœ ìœ í˜•5",{"ì˜ˆì™¸.1"}),
    #"ë³€ê²½ëœ ìœ í˜•6" = Table.TransformColumnTypes(#"ì œê±°ëœ ì—´ ìˆ˜5",{{"ì˜ˆì™¸.2.1", type text}}),
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜" = Table.RenameColumns(#"ë³€ê²½ëœ ìœ í˜•6",{{"ì˜ˆì™¸.2.1", "ë²•ì¸ë³„ CoA"}, {"ì˜ˆì™¸.2.2", "ë²•ì¸ë³„ ê³„ì •ê³¼ëª©ëª…"}, {"Column2", "ë‹¹ê¸°_ì„¸ë¶€"}, {"Column3", "ë‹¹ê¸°_ê¸ˆì•¡"}, {"Column4", "ì „ê¸°_ì„¸ë¶€"}, {"Column5", "ì „ê¸°_ê¸ˆì•¡"}}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©8" = Table.AddColumn(#"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜", "íŠ¹ìˆ˜", each if[ì „ê¸°_ì„¸ë¶€] <> null and [ë‹¹ê¸°_ì„¸ë¶€] = null then "ë‹¹ì—†ì „ìˆ"  else [ë‹¹ê¸°_ì„¸ë¶€]),
    #"ì¡°ê±´ ì—´ì´ ì¶”ê°€ë¨1" = Table.AddColumn(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©8", "ì‚¬ìš©ì ì§€ì •", each if [íŠ¹ìˆ˜] = "ë‹¹ì—†ì „ìˆ" then 0 else [ë‹¹ê¸°_ì„¸ë¶€]),
    #"ì œê±°ëœ ì—´ ìˆ˜9" = Table.RemoveColumns(#"ì¡°ê±´ ì—´ì´ ì¶”ê°€ë¨1",{"ë‹¹ê¸°_ì„¸ë¶€", "íŠ¹ìˆ˜"}),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜2" = Table.ReorderColumns(#"ì œê±°ëœ ì—´ ìˆ˜9",{"ë²•ì¸ì½”ë“œ", "ë²•ì¸ë³„ CoA", "ë²•ì¸ë³„ ê³„ì •ê³¼ëª©ëª…", "ì‚¬ìš©ì ì§€ì •", "ë‹¹ê¸°_ê¸ˆì•¡", "ì „ê¸°_ì„¸ë¶€", "ì „ê¸°_ê¸ˆì•¡"}),
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜1" = Table.RenameColumns(#"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜2",{{"ì‚¬ìš©ì ì§€ì •", "ë‹¹ê¸°_ì„¸ë¶€"}}),
    #"ë³€ê²½ëœ ìœ í˜•9" = Table.TransformColumnTypes(#"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜1",{{"ë‹¹ê¸°_ì„¸ë¶€", type text}, {"ë‹¹ê¸°_ê¸ˆì•¡", type text}, {"ì „ê¸°_ì„¸ë¶€", type text}, {"ì „ê¸°_ê¸ˆì•¡", type text}}),
    #"ë°”ê¾¼ ê°’1" = Table.ReplaceValue(#"ë³€ê²½ëœ ìœ í˜•9",null,"",Replacer.ReplaceValue,{"ë‹¹ê¸°_ì„¸ë¶€", "ë‹¹ê¸°_ê¸ˆì•¡", "ì „ê¸°_ì„¸ë¶€", "ì „ê¸°_ê¸ˆì•¡"}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©1" = Table.AddColumn(#"ë°”ê¾¼ ê°’1", "ë‹¹ê¸° ê¸ˆì•¡", each if [ë‹¹ê¸°_ì„¸ë¶€] = "" then [ë‹¹ê¸°_ê¸ˆì•¡] else [ë‹¹ê¸°_ì„¸ë¶€]),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©2" = Table.AddColumn(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©1", "ì „ê¸° ê¸ˆì•¡", each if [ì „ê¸°_ì„¸ë¶€] = "" then [ì „ê¸°_ê¸ˆì•¡] else [ì „ê¸°_ì„¸ë¶€]),
    #"ì œê±°ëœ ì—´ ìˆ˜6" = Table.RemoveColumns(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©2",{"ë‹¹ê¸°_ì„¸ë¶€", "ë‹¹ê¸°_ê¸ˆì•¡", "ì „ê¸°_ì„¸ë¶€", "ì „ê¸°_ê¸ˆì•¡"}),
    #"ì¤‘ë³µëœ ì—´2" = Table.DuplicateColumn(#"ì œê±°ëœ ì—´ ìˆ˜6", "ë‹¹ê¸° ê¸ˆì•¡", "ë‹¹ê¸° ê¸ˆì•¡ - ë³µì‚¬"),
    #"ì¤‘ë³µëœ ì—´3" = Table.DuplicateColumn(#"ì¤‘ë³µëœ ì—´2", "ì „ê¸° ê¸ˆì•¡", "ì „ê¸° ê¸ˆì•¡ - ë³µì‚¬"),
    #"ë³€ê²½ëœ ìœ í˜•7" = Table.TransformColumnTypes(#"ì¤‘ë³µëœ ì—´3",{{"ë‹¹ê¸° ê¸ˆì•¡", Int64.Type}, {"ì „ê¸° ê¸ˆì•¡", Int64.Type}}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©3" = Table.AddColumn(#"ë³€ê²½ëœ ìœ í˜•7", "ì‹ë³„ì½”ë“œ", each [ë²•ì¸ì½”ë“œ] & "_" & [ë²•ì¸ë³„ CoA]),
    #"ë°”ê¾¼ ê°’" = Table.ReplaceValue(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©3","â–³","-",Replacer.ReplaceText,{"ë‹¹ê¸° ê¸ˆì•¡ - ë³µì‚¬", "ì „ê¸° ê¸ˆì•¡ - ë³µì‚¬"}),
    #"ë³€ê²½ëœ ìœ í˜•3" = Table.TransformColumnTypes(#"ë°”ê¾¼ ê°’",{{"ë‹¹ê¸° ê¸ˆì•¡ - ë³µì‚¬", Int64.Type}, {"ì „ê¸° ê¸ˆì•¡ - ë³µì‚¬", Int64.Type}}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©4" = Table.AddColumn(#"ë³€ê²½ëœ ìœ í˜•3", "ë‹¹ê¸° ì”ì•¡", each try [ë‹¹ê¸° ê¸ˆì•¡] otherwise [#"ë‹¹ê¸° ê¸ˆì•¡ - ë³µì‚¬"]),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©5" = Table.AddColumn(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©4", "ì „ê¸° ì”ì•¡", each try [ì „ê¸° ê¸ˆì•¡] otherwise [#"ì „ê¸° ê¸ˆì•¡ - ë³µì‚¬"]),
    #"ì œê±°ëœ ì—´ ìˆ˜7" = Table.RemoveColumns(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©5",{"ë‹¹ê¸° ê¸ˆì•¡", "ì „ê¸° ê¸ˆì•¡", "ë‹¹ê¸° ê¸ˆì•¡ - ë³µì‚¬", "ì „ê¸° ê¸ˆì•¡ - ë³µì‚¬"}),
    #"ë³€ê²½ëœ ìœ í˜•8" = Table.TransformColumnTypes(#"ì œê±°ëœ ì—´ ìˆ˜7",{{"ë‹¹ê¸° ì”ì•¡", Int64.Type}, {"ì „ê¸° ì”ì•¡", Int64.Type}, {"ì‹ë³„ì½”ë“œ", type text}}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©6" = Table.AddColumn(#"ë³€ê²½ëœ ìœ í˜•8", "ë‹¹ê¸°", each if Text.Contains([ë²•ì¸ë³„ ê³„ì •ê³¼ëª©ëª…], "ê²°ì†ê¸ˆ") then [ë‹¹ê¸° ì”ì•¡] * -1 else [ë‹¹ê¸° ì”ì•¡]),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©7" = Table.AddColumn(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©6", "ì „ê¸°", each if Text.Contains([ë²•ì¸ë³„ ê³„ì •ê³¼ëª©ëª…], "ê²°ì†ê¸ˆ") then [ì „ê¸° ì”ì•¡] * -1 else [ì „ê¸° ì”ì•¡]),
    #"ë³€ê²½ëœ ìœ í˜•10" = Table.TransformColumnTypes(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©7",{{"ë‹¹ê¸°", Int64.Type}, {"ì „ê¸°", Int64.Type}}),
    #"ì œê±°ëœ ì—´ ìˆ˜8" = Table.RemoveColumns(#"ë³€ê²½ëœ ìœ í˜•10",{"ë‹¹ê¸° ì”ì•¡", "ì „ê¸° ì”ì•¡", "ì „ê¸°"})
in
    #"ì œê±°ëœ ì—´ ìˆ˜8"
```

---

### 4.2 TB ì¿¼ë¦¬ (ì‹œì‚°í‘œ í†µí•©)

**ì¿¼ë¦¬ ì´ë¦„**: `TB`
**ìš©ë„**: BS + PL ê²°í•© (í•©ì” í¬í•¨ì‹œ ì¶”ê°€)

```m
let
    ì›ë³¸ = Table.Combine({BS, PL})
    // í•©ì” ì‹œì‚°í‘œê°€ ìˆëŠ” ê²½ìš°:
    // #"ì¶”ê°€ëœ ì¿¼ë¦¬" = Table.Combine({ì›ë³¸, í•©ì”})
in
    ì›ë³¸
```

---

### 4.3 PTB ì¿¼ë¦¬ (ìµœì¢… ì¶œë ¥)

**ì¿¼ë¦¬ ì´ë¦„**: `PTB`
**ìš©ë„**: CoA ë§¤í•‘ì´ ì™„ë£Œëœ ìµœì¢… ì‹œì‚°í‘œ

```m
let
    ì›ë³¸ = Table.NestedJoin(TB, {"ì‹ë³„ì½”ë“œ"}, CoA_Processed, {"ì‹ë³„ì½”ë“œ"}, "CoA_Processed", JoinKind.LeftOuter),
    #"í™•ì¥ëœ CoA_Mapping" = Table.ExpandTableColumn(ì›ë³¸, "CoA_Processed", {"PwC_CoA"}, {"CoA_Processed.PwC_CoA"}),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜" = Table.ReorderColumns(#"í™•ì¥ëœ CoA_Mapping",{"ë²•ì¸ì½”ë“œ", "ë²•ì¸ë³„ CoA", "ë²•ì¸ë³„ ê³„ì •ê³¼ëª©ëª…", "CoA_Processed.PwC_CoA", "ì‹ë³„ì½”ë“œ", "ë‹¹ê¸°"}),
    #"ì œê±°ëœ ì—´ ìˆ˜" = Table.RemoveColumns(#"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜",{"ì‹ë³„ì½”ë“œ"}),
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜" = Table.RenameColumns(#"ì œê±°ëœ ì—´ ìˆ˜",{{"CoA_Processed.PwC_CoA", "PwC_CoA"}}),
    #"ë³‘í•©ëœ ì¿¼ë¦¬" = Table.NestedJoin(#"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜", {"PwC_CoA"}, Master, {"TB Account"}, "Master", JoinKind.LeftOuter),
    #"í™•ì¥ëœ ë¶€í˜¸" = Table.ExpandTableColumn(#"ë³‘í•©ëœ ì¿¼ë¦¬", "Master", {"Account Name", "ëŒ€ë¶„ë¥˜", "ì¤‘ë¶„ë¥˜", "ë¶€í˜¸"}, {"Account Name", "ëŒ€ë¶„ë¥˜", "ì¤‘ë¶„ë¥˜", "ë¶€í˜¸"}),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜1" = Table.ReorderColumns(#"í™•ì¥ëœ ë¶€í˜¸",{"ë²•ì¸ì½”ë“œ", "ë²•ì¸ë³„ CoA", "ë²•ì¸ë³„ ê³„ì •ê³¼ëª©ëª…", "PwC_CoA", "ë¶€í˜¸", "ë‹¹ê¸°"}),
    #"ë³€ê²½ëœ ìœ í˜•" = Table.TransformColumnTypes(#"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜1",{{"Account Name", type text}, {"ë¶€í˜¸", Int64.Type}}),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜2" = Table.ReorderColumns(#"ë³€ê²½ëœ ìœ í˜•",{"ë²•ì¸ì½”ë“œ", "ë²•ì¸ë³„ CoA", "ë²•ì¸ë³„ ê³„ì •ê³¼ëª©ëª…", "PwC_CoA", "Account Name", "ë¶€í˜¸", "ë‹¹ê¸°"}),
    #"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©" = Table.AddColumn(#"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜2", "ë‹¹ê¸° ì”ì•¡", each [ë‹¹ê¸°] * [#"ë¶€í˜¸"]),
    #"ë³€ê²½ëœ ìœ í˜•2" = Table.TransformColumnTypes(#"ì¶”ê°€ëœ ì‚¬ìš©ì ì§€ì • í•­ëª©",{{"ë‹¹ê¸° ì”ì•¡", Int64.Type}}),
    #"ì œê±°ëœ ì—´ ìˆ˜1" = Table.RemoveColumns(#"ë³€ê²½ëœ ìœ í˜•2",{"ë‹¹ê¸°", "ë¶€í˜¸"}),
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜1" = Table.RenameColumns(#"ì œê±°ëœ ì—´ ìˆ˜1",{{"Account Name", "PwC_ê³„ì •ëª…"}, {"ë‹¹ê¸° ì”ì•¡", "ê¸ˆì•¡"}})
in
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜1"
```

**ë¡œë“œ ìœ„ì¹˜**: BSPL ì‹œíŠ¸, í…Œì´ë¸” ì´ë¦„ `PTB`

---

### 4.4 Link ì¿¼ë¦¬

**ì¿¼ë¦¬ ì´ë¦„**: `Link`
**ìš©ë„**: ë²•ì¸ë³„ í´ë” ë§í¬ ìƒì„±

```m
let
    ì›ë³¸ = Raw_Data,
    #"ì œê±°ëœ ë‹¤ë¥¸ ì—´ ìˆ˜" = Table.SelectColumns(ì›ë³¸,{"Name", "Folder Path"}),
    #"ì¤‘ë³µëœ ì—´" = Table.DuplicateColumn(#"ì œê±°ëœ ë‹¤ë¥¸ ì—´ ìˆ˜", "Folder Path", "Folder Path - ë³µì‚¬"),
    #"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• 2" = Table.SplitColumn(#"ì¤‘ë³µëœ ì—´", "Folder Path - ë³µì‚¬", Splitter.SplitTextByDelimiter("[", QuoteStyle.None), {"Folder Path - ë³µì‚¬.1", "Folder Path - ë³µì‚¬.2"}),
    #"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• " = Table.SplitColumn(#"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• 2", "Folder Path - ë³µì‚¬.2", Splitter.SplitTextByDelimiter("]", QuoteStyle.None), {"Folder Path - ë³µì‚¬.2.1", "Folder Path - ë³µì‚¬.2.2"}),
    #"ì œê±°ëœ ì—´ ìˆ˜" = Table.RemoveColumns(#"êµ¬ë¶„ ê¸°í˜¸ì— ë”°ë¼ ì—´ ë¶„í• ",{"Folder Path - ë³µì‚¬.2.2", "Folder Path - ë³µì‚¬.1"}),
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜2" = Table.RenameColumns(#"ì œê±°ëœ ì—´ ìˆ˜",{{"Folder Path - ë³µì‚¬.2.1", "ë²•ì¸ì½”ë“œ"}}),
    #"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜" = Table.ReorderColumns(#"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜2",{"ë²•ì¸ì½”ë“œ", "Name", "Folder Path"}),
    #"ì œê±°ëœ ì—´ ìˆ˜1" = Table.RemoveColumns(#"ë‹¤ì‹œ ì •ë ¬í•œ ì—´ ìˆ˜",{"Name"}),
    #"ì œê±°ëœ ì¤‘ë³µ í•­ëª© ìˆ˜" = Table.Distinct(#"ì œê±°ëœ ì—´ ìˆ˜1"),
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜1" = Table.RenameColumns(#"ì œê±°ëœ ì¤‘ë³µ í•­ëª© ìˆ˜",{{"Folder Path", "Link"}})
in
    #"ì´ë¦„ì„ ë°”ê¾¼ ì—´ ìˆ˜1"
```

**ë¡œë“œ ìœ„ì¹˜**: HideSheet ì‹œíŠ¸, í…Œì´ë¸” ì´ë¦„ `Link`

---

## 5. ì¿¼ë¦¬ ìƒì„± ìˆœì„œ

### 5.1 ì˜ì¡´ì„± ìˆœì„œ (ì¤‘ìš”!)

ì¿¼ë¦¬ëŠ” **ë°˜ë“œì‹œ ì•„ë˜ ìˆœì„œ**ë¡œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤:

```
[1ë‹¨ê³„: ê¸°ë³¸ ì„¤ì • - ì—°ê²°ë§Œ ë§Œë“¤ê¸°]
1. ë©”ì¸ì£¼ì†Œ
2. íšŒì‚¬ê²°ì‚° ì£¼ì†Œ
3. Mode

[2ë‹¨ê³„: ë°ì´í„° ì†ŒìŠ¤ - ì—°ê²°ë§Œ ë§Œë“¤ê¸°]
4. Corp
5. Corp_Date
6. Master
7. CoA
8. CoA_Processed
9. Raw_Data

[3ë‹¨ê³„: ë°ì´í„° ë³€í™˜ - ì—°ê²°ë§Œ ë§Œë“¤ê¸°]
10. BS
11. PL (ë˜ëŠ” ì›”ë³„ PL)
12. TB

[4ë‹¨ê³„: ìµœì¢… ì¶œë ¥ - í…Œì´ë¸”ë¡œ ë¡œë“œ]
13. PTB â†’ BSPL ì‹œíŠ¸
14. Link â†’ HideSheet

[5ë‹¨ê³„: ë””ë ‰í„°ë¦¬ (ì„ íƒ)]
15. ë””ë ‰í„°ë¦¬ â†’ DirectoryURL ì‹œíŠ¸
```

---

### 5.2 ë¡œë“œ ì„¤ì • ìš”ì•½

| ì¿¼ë¦¬ | ë¡œë“œ ë°©ì‹ | ìœ„ì¹˜ | í…Œì´ë¸”ëª… |
|------|----------|------|----------|
| ë©”ì¸ì£¼ì†Œ | ì—°ê²°ë§Œ | - | - |
| íšŒì‚¬ê²°ì‚° ì£¼ì†Œ | ì—°ê²°ë§Œ | - | - |
| Mode | ì—°ê²°ë§Œ | - | - |
| Corp | ì—°ê²°ë§Œ | - | - |
| Corp_Date | ì—°ê²°ë§Œ | - | - |
| Master | ì—°ê²°ë§Œ | - | - |
| CoA | ì—°ê²°ë§Œ | - | - |
| CoA_Processed | ì—°ê²°ë§Œ | - | - |
| Raw_Data | ì—°ê²°ë§Œ | - | - |
| BS | ì—°ê²°ë§Œ | - | - |
| PL | ì—°ê²°ë§Œ | - | - |
| TB | ì—°ê²°ë§Œ | - | - |
| **PTB** | **í…Œì´ë¸”** | **BSPL** | **PTB** |
| **Link** | **í…Œì´ë¸”** | **HideSheet** | **Link** |
| **ë””ë ‰í„°ë¦¬** | **í…Œì´ë¸”** | **DirectoryURL** | **ë””ë ‰í„°ë¦¬** |

---

## 6. ë¬¸ì œ í•´ê²°

### 6.1 "ë ˆì½”ë“œì˜ 'ê²½ë¡œ' í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"

**ì›ì¸**: TempPath í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª…ì´ `ê²½ë¡œ`ê°€ ì•„ë‹˜

**í•´ê²°**:
1. HideSheet ì‹œíŠ¸ì—ì„œ TempPath í…Œì´ë¸” í™•ì¸
2. í—¤ë”ë¥¼ `ê²½ë¡œ`ë¡œ ë³€ê²½
3. ì¿¼ë¦¬ ìƒˆë¡œê³ ì¹¨

---

### 6.2 "Corp ì—´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"

**ì›ì¸**: Corp ì¿¼ë¦¬ë³´ë‹¤ Raw_Data ì¿¼ë¦¬ë¥¼ ë¨¼ì € ìƒì„±

**í•´ê²°**:
1. ì˜ì¡´ì„± ìˆœì„œëŒ€ë¡œ ì¿¼ë¦¬ ì¬ìƒì„±
2. Corp â†’ Raw_Data ìˆœì„œ ì¤€ìˆ˜

---

### 6.3 SharePoint ì—°ê²° ì˜¤ë¥˜

**ì›ì¸**: ì¸ì¦ ë¬¸ì œ ë˜ëŠ” URL ì˜¤ë¥˜

**í•´ê²°**:
1. ë°ì´í„° â†’ ì¿¼ë¦¬ ë° ì—°ê²° â†’ ë°ì´í„° ì›ë³¸ ì„¤ì •
2. SharePoint ì—°ê²° ì„ íƒ â†’ ìê²© ì¦ëª… í¸ì§‘
3. ì¡°ì§ ê³„ì •ìœ¼ë¡œ ë‹¤ì‹œ ë¡œê·¸ì¸

---

### 6.4 ë²•ì¸ì½”ë“œ ì¶”ì¶œ ì‹¤íŒ¨

**ì›ì¸**: í´ë” êµ¬ì¡°ê°€ `[ë²•ì¸ì½”ë“œ]` íŒ¨í„´ì„ ë”°ë¥´ì§€ ì•ŠìŒ

**ê¸°ëŒ€ êµ¬ì¡°**:
```
/Shared Documents/â˜…ì‹œì—°ìš©í´ë”â˜…/HRE/2512/[HRE-001]/ì¬ë¬´ìƒíƒœí‘œ.xlsx
```

**í•´ê²°**:
1. SharePoint í´ë” êµ¬ì¡° í™•ì¸
2. ë²•ì¸ í´ë”ëª…ì„ `[HRE-001]` í˜•ì‹ìœ¼ë¡œ ë³€ê²½
3. ë˜ëŠ” Raw_Data ì¿¼ë¦¬ì˜ ë²•ì¸ì½”ë“œ ì¶”ì¶œ ë¡œì§ ìˆ˜ì •

---

## ë¶€ë¡: SPO í´ë” êµ¬ì¡° ê¶Œì¥ì•ˆ

```
â˜…ì‹œì—°ìš©í´ë”â˜…/
â””â”€â”€ HRE/
    â””â”€â”€ 2512/                       â† ê²°ì‚°ì—°ì›” (YYMM)
        â”œâ”€â”€ [HRE-001]/              â† ë²•ì¸ì½”ë“œ (ëŒ€ê´„í˜¸ í•„ìˆ˜!)
        â”‚   â”œâ”€â”€ ì¬ë¬´ìƒíƒœí‘œ.xlsx
        â”‚   â”œâ”€â”€ ì›”ë³„ì†ìµê³„ì‚°ì„œ.xlsx
        â”‚   â””â”€â”€ í•©ê³„ì”ì•¡ì‹œì‚°í‘œ.xlsx
        â”œâ”€â”€ [HRE-002]/
        â”‚   â””â”€â”€ ...
        â””â”€â”€ [HRE-003]/
            â””â”€â”€ ...
```

**ì¤‘ìš”**: ë²•ì¸ í´ë”ëª…ì€ ë°˜ë“œì‹œ `[ë²•ì¸ì½”ë“œ]` í˜•ì‹ (ëŒ€ê´„í˜¸ í¬í•¨)ì´ì–´ì•¼ í•©ë‹ˆë‹¤!
